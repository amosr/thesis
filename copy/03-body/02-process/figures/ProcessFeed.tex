%!TEX root = ../Main.tex

\begin{figure}

\newcommand\vs {\ti{vs}}
\newcommand\ps {\ti{ps}}

$$
  \boxed{
    \ProcsFeed
      {(\Chan \mapsto \overline{Value})~}
      {\sgl{\Proc}}
      {(\Chan \mapsto \overline{Value})~}
      {\sgl{\Proc}}
  }
$$

$$
\ruleIN{
  \forall p \in ps.~
  p[@instrs@][p[@label@]] = @exit@
% \quad
%   \forall (c \mapsto v) \in i.~ v = []
}{
  \ProcsFeed
    {i}
    {ps}
    {\emptyset}
    {ps}
}{FeedExit}
\ruleIN{
  \ProcsShake
    {ps}
    {\cdot}
    {ps'}
\quad
  \ProcsFeed{i}{ps'}{o}{ps''}
}{
  \ProcsFeed
    {i}
    {ps}
    {o}
    {ps''}
}{FeedInternal}
$$

$$
\ruleIN{
  \ProcsShake
    {ps}
    {\Push~c~v}
    {ps'}
\quad
  \ProcsFeed
    {i}
    {ps'}
    {o}
    {ps''}
}{
  \ProcsFeed
    {i}
    {ps}
    {o[c \mapsto ([v] \listappend o[c])]}
    {ps''}
}{FeedPush}
\ruleIN{
  \ProcsShake
    {ps}
    {\Close~c}
    {ps'}
\quad
  \ProcsFeed
    {i}
    {ps'}
    {o}
    {ps''}
}{
  \ProcsFeed
    {i}
    {ps}
    {o[c \mapsto []]}
    {ps''}
}{FeedClose}
$$





$$
\ruleIN{
%   (\forall p \in \ps.~c \not\in p[@outs@])
% \quad
  \ProcsInject
    {ps}
    {(\Push~c~v)}
    {ps'}
\quad
  \ProcsFeed
    {i[c \mapsto \vs]}
    {ps'}
    {o}
    {ps''}
}{
  \ProcsFeed
    {i[c \mapsto ([v] \listappend vs)]}
    {ps}
    {o}
    {ps''}
}{FeedEnvPush}
$$

$$
\ruleIN{
%   (\forall p \in \ps.~c \not\in p[@outs@])
% \quad
  \ProcsInject
    {ps}
    {(\Close~c)}
    {ps'}
\quad
  \ProcsFeed
    {(i\setminus\sgl{c})}
    {ps'}
    {o}
    {ps''}
}{
  \ProcsFeed
    {i[c \mapsto [] ]}
    {ps}
    {o}
    {ps''}
}{FeedEnvClose}
$$



\caption{Feeding Process Networks}
\label{fig:Process:Eval:Feed}
\end{figure}

