%!TEX root = ../Main.tex

\begin{figure}

\newcommand\vs {\ti{vs}}
\newcommand\ps {\ti{ps}}

$$
  \boxed{
    \ProcsFeed
      {(\Chan \mapsto \overline{Value})~}
      {\sgl{\Proc}}
      {(\Chan \mapsto \overline{Value})~}
      {\sgl{\Proc}}
  }
$$

$$
\ruleIN{
  \ProcsShake
    {ps}
    {\cdot}
    {ps'}
\qquad
  \ProcsFeed{i}{ps'}{o}{ps''}
}{
  \ProcsFeed
    {i}
    {ps}
    {o}
    {ps''}
}{FeedInternal}
$$

$$
\ruleIN{
  \ProcsShake
    {ps}
    {\Push~c~v}
    {ps'}
\qquad
  \ProcsFeed
    {i}
    {ps'}
    {o}
    {ps''}
\qquad
  (c \mapsto \vs) \in o
}{
  \ProcsFeed
    {i}
    {ps}
    {o[c \mapsto ([v] \listappend \vs)]}
    {ps''}
}{FeedPush}
$$

$$
\ruleIN{
  \ProcsShake
    {ps}
    {\Close~c}
    {ps'}
\qquad
  \ProcsFeed
    {i}
    {ps'}
    {o}
    {ps''}
}{
  \ProcsFeed
    {i}
    {ps}
    {o[c \mapsto []]}
    {ps''}
}{FeedClose}
$$





$$
\ruleIN{
%   (\forall p \in \ps.~c \not\in p[@outs@])
% \qquad
  \ProcsInject
    {ps}
    {(\Push~c~v)}
    {ps'}
\qquad
  \ProcsFeed
    {i[c \mapsto \vs]}
    {ps'}
    {o}
    {ps''}
}{
  \ProcsFeed
    {i[c \mapsto ([v] \listappend vs)]}
    {ps}
    {o}
    {ps''}
}{FeedExternalPush}
$$

$$
\ruleIN{
%  (\forall p \in \ps.~c \not\in p[@outs@])
%\qquad
  \ProcsInject
    {ps}
    {(\Close~c)}
    {ps'}
\qquad
  \ProcsFeed
    {i}
    {ps'}
    {o}
    {ps''}
}{
  \ProcsFeed
    {i[c \mapsto [] ]}
    {ps}
    {o}
    {ps''}
}{FeedExternalClose}
$$



\caption{Feeding Process Networks}
\label{fig:Process:Eval:Feed}
\end{figure}

