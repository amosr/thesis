%!TEX root = ../Main.tex

\begin{figure}

\newcommand\vs {\ti{vs}}
\newcommand\accs {\ti{accs}}
\newcommand\network {\ti{ps}}

$$
  \boxed{
    \ProcsFeed
      {(\Chan \mapsto \overline{Value})~}
      {\sgl{\Proc}}
      {(\Chan \mapsto \overline{Value})~}
      {\sgl{\Proc}}
  }
$$

% $$
% \ruleIN{
%   \forall c \in \accs.~
%   \accs~c~=~[]
% }{
%   \ProcsFeed
%     {\accs}
%     {\network}
%     {\accs}
%     {\network}
% }{FeedStart}
% $$

% $$
% \ruleIN{
%   \ProcsFeed
%     {\accs}
%     {\network}
%     {\accs'}
%     {\network'}
% \quad
%   \ProcsShake
%     {\network'}
%     {\tau}
%     {\network''}
% }{
%   \ProcsFeed
%     {\accs}
%     {\network}
%     {\accs'}
%     {\network''}
% }{FeedInternal}
% $$



% $$
% \ruleIN{
%   \ProcsFeed
%     {\accs}
%     {\network}
%     {\accs'}
%     {\network'}
% \quad
%   \ProcsShake
%     {\network'}
%     {\Push~c~v}
%     {\network''}
% }{
%   \ProcsFeed
%     {\accs}
%     {\network}
%     {c=\accs'~c \listappend [v], \accs'}
%     {\network''}
% }{FeedPush}
% $$


$$
\ruleIN{
  \ProcsShake
    {ps}
    {\cdot}
    {ps'}
}{
  \ProcsFeed
    {cvs}
    {ps}
    {cvs}
    {ps'}
}{FeedInternal}
$$

$$
\ruleIN{
  \ProcsShake
    {ps}
    {\Push~c~v}
    {ps'}
}{
  \ProcsFeed
    {cvs}
    {ps}
    {cvs[c \mapsto (cvs[c] \listappend v)]}
    {ps'}
}{FeedPush}
\ruleIN{
  \ProcsShake
    {ps}
    {\Close~c}
    {ps'}
}{
  \ProcsFeed
    {cvs}
    {ps}
    {cvs}
    {ps'}
}{FeedClose}
$$





$$
\ruleIN{
  (\forall p \in \network.~c \not\in p[@outs@])
\qquad
  \ProcsInject
    {ps}
    {(\Push~c~v)}
    {ps'}
}{
  \ProcsFeed
    {cvs[c \mapsto ([v] \listappend vs)]}
    {ps}
    {cvs[c \mapsto vs~]}
    {ps'}
}{FeedExternalPush}
$$

$$
\ruleIN{
  (\forall p \in \network.~c \not\in p[@outs@])
\qquad
  \ProcsInject
    {ps}
    {(\Close~c)}
    {ps'}
}{
  \ProcsFeed
    {cvs[c \mapsto [] ]}
    {ps}
    {cvs}
    {ps'}
}{FeedExternalClose}
$$



\caption{Feeding Process Networks}
\label{fig:Process:Eval:Feed}
\end{figure}

