%!TEX root = ../Main.tex

\begin{figure}

$$
\Action,~a  ~~~ @::=@ ~~~ \cdot ~~|~~ \Push~\Chan~\Value ~~|~~ \Close~\Chan
$$

$$
\boxed{\ProcInject{\Proc}{\Action}{\Proc}}
$$

$$
\ruleIN{
  p[\lstiproc@ins@][c] = \lstiproc@none@
}{
  \ProcInject{p}{(\Push~c~v)}{p~[\lstiproc@ins@ \mapsto (p[\lstiproc@ins@][c \mapsto \lstiproc@pending@~v]) ] }
}{InjectPush}
$$

$$
\ruleIN{
  p[\lstiproc@ins@][c] = \lstiproc@none@
}{
  \ProcInject{p}{(\Close~c)}{p~[\lstiproc@ins@ \mapsto (p[\lstiproc@ins@][c \mapsto \lstiproc@closed@]) ] }
}{InjectClose}
$$

$$
\ruleIN{
  c \not\in p[\lstiproc@ins@]
}{
  \ProcInject{p}{(\Push~c~v)}{p}
}{InjectNopPush}
%
\enskip
%
\ruleIN{
  c \not\in p[\lstiproc@ins@]
}{
  \ProcInject{p}{(\Close~c)}{p}
}{InjectNopClose}
$$

$$
\ruleAx{
  \ProcInject{p}{(\cdot)}{p}
}{InjectNopInternal}
$$


$$
\boxed{\ProcsInject{\sgl{\Proc}}{\Action}{\sgl{\Proc}}}
$$

$$
\ruleIN{
  \{~ \ProcInject{p_i}{a}{p'_i} ~\}^i
}{
  \ProcsInject{\sgl{p_i}^i}{a}{\sgl{p'_i}^i}
}{InjectMany}
$$

\caption{Injection of message actions into input channels}
\label{fig:Process:Eval:Inject}
\end{figure}


